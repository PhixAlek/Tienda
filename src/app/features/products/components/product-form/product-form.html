<form #f="ngForm" (ngSubmit)="submit(f)" class="product-form">
  <h2>{{ product() ? 'Editar producto' : 'Crear producto' }}</h2>

  <div class="form-group">
    <label>Nombre</label>
    <input
      name="nombre"
      [(ngModel)]="nombre"
      required
      minlength="2"
      #nombreCtrl="ngModel"
    />
    <small class="error" *ngIf="nombreCtrl.invalid && nombreCtrl.touched">
      {{ nombreCtrl.errors?.['required'] ? 'El nombre es obligatorio.' : '' }}
      {{ nombreCtrl.errors?.['minlength'] ? 'Debe tener al menos 2 caracteres.' : '' }}
    </small>
  </div>

  <div class="form-group">
    <label>Precio</label>
    <input
      type="number"
      name="precio"
      [(ngModel)]="precio"
      required
      min="0"
      #precioCtrl="ngModel"
    />
    <small class="error" *ngIf="precioCtrl.invalid && precioCtrl.touched">
      {{ precioCtrl.errors?.['required'] ? 'El precio es obligatorio.' : '' }}
      {{ precioCtrl.errors?.['min'] ? 'Debe ser mayor o igual a 0.' : '' }}
    </small>
  </div>

  <div class="form-group">
    <label>Stock (opcional)</label>
    <input type="number" name="stock" [(ngModel)]="stock" min="0" />
  </div>

  <div class="actions">
    <button type="submit" [disabled]="f.invalid || loading">
      @if (loading) {
        <mat-spinner diameter="20"></mat-spinner> Guardando...
      } @else {
        {{ product() ? 'Actualizar' : 'Crear' }}
      }
    </button>
    <button type="button" (click)="cancel.emit()">Cancelar</button>
  </div>
</form>
